jQuery,$.fn.drag_drop_exerc=function(e){var i={},e=$.extend({itemClass:"item",featuredItemClass:"featuredItens",confirmarClass:"confirmar",call:void 0,limiteAlvo:1,relacionar:!1},e),a=(i.SETTINGS=e,i.THIS=this,i.$container=i.THIS,i.$activeItem=null,i.$activeItemOld=null,i.$alvoItem=null,i.$activeItemEncap=null,i.indiceArraste=0,i.indiceAlvo=0,i.individual=!0,!!i.SETTINGS.relacionar);function n(e){if($(e).attr("alvo")||$(e).parent().attr("alvo"))if($(e).parent().attr("alvo")?i.$alvoItem=$(e).parent():i.$alvoItem=$(e),$(i.$activeItem).attr("encap")){if(i.$activeItemEncap&&!$(i.$activeItemEncap).attr("encap"))if(!i.individual)return $(i.$alvoItem)[0].children.length>=i.SETTINGS.limiteAlvo?void 0:(t=$(i.$activeItemEncap).clone(),a=$(i.$activeItemEncap).parent(),$(t).addClass("cloneItens"),$(i.$alvoItem).append(i.$activeItemEncap),a.append(t),$(i.$activeItemEncap).attr("encap","init"),i.$activeItem=null,i.$alvoItem=null,i.$activeItemEncap=null,void $("."+i.SETTINGS.featuredItemClass).removeClass(i.SETTINGS.featuredItemClass));if(i.$activeItemOld){if($(i.$activeItemOld).parent()!=$(i.$alvoItem)){if(i.individual){var e=$(i.$activeItemOld).parent();$(i.$alvoItem).append(i.$activeItemOld),1<$(i.$alvoItem)[0].children.length&&e.append(i.$activeItem)}else{if($(i.$alvoItem)[0].children.length>=i.SETTINGS.limiteAlvo)return;$(i.$alvoItem).append(i.$activeItemOld)}i.$activeItem=null,i.$alvoItem=null,i.$activeItemOld=null,$("."+i.SETTINGS.featuredItemClass).removeClass(i.SETTINGS.featuredItemClass)}}else i.$activeItemOld=i.$activeItem}else{var t=$(i.$activeItem).clone(),a=$(i.$activeItem).parent();$(t).addClass("cloneItens"),$(i.$alvoItem).append(i.$activeItem),a.append(t),$(i.$activeItem).attr("encap","init"),i.$activeItem=null,i.$alvoItem=null,$("."+i.SETTINGS.featuredItemClass).removeClass(i.SETTINGS.featuredItemClass)}else $(i.$activeItem).attr("encap")&&(e=$(i.$activeItem)[0].parentInit,$(e).find(".cloneItens").remove(),$(e).append(i.$activeItem),$(i.$activeItem).removeAttr("encap"),i.$activeItem=null,i.$alvoItem=null,i.$activeItemOld=null,$("."+i.SETTINGS.featuredItemClass).removeClass(i.SETTINGS.featuredItemClass));s()}function r(e){i.$activeItem=this,e.originalEvent.dataTransfer.effectAllowed="move",e.originalEvent.dataTransfer.setData("text/html",this.innerHTML),i.action={status:"drag",response:{drag:this,drop:null}},$("."+i.SETTINGS.featuredItemClass).removeClass(i.SETTINGS.featuredItemClass),$(i.$activeItem).addClass(i.SETTINGS.featuredItemClass),i.SETTINGS.call(i)}function l(e){return e.preventDefault&&e.preventDefault(),e.originalEvent.dataTransfer.dropEffect="move",i.action={status:"over",response:{drag:this,drop:null}},i.SETTINGS.call(i),!1}function o(e){e.stopPropagation&&e.stopPropagation();var e=i.$activeItem,t=this;if($(t).attr("alvo")||$(t).parent().attr("alvo")){if(!i.individual)if($(t).parent().attr("alvo")){if($(t).parent().children().length>=i.SETTINGS.limiteAlvo)return!1}else if($(t).children().length>=i.SETTINGS.limiteAlvo)return!1;$(e).parent().removeAttr("a"+$(e).attr("indiceArraste")),e.oldParent||(e.oldParent=$(e).parent());var a=null,n=((a=$(t).parent().attr("alvo")?$(t).parent():$(t)).append(e),a.attr("a"+$(e).attr("indiceArraste"),"1"),i.individual&&1<a.children().length&&(a.removeAttr("a"+a.children().eq(0).attr("arraste")),n=a.children().eq(0)[0].oldParent,$(n).find(".cloneItens").remove(),$(n).append(a.children().eq(0)),$(a.children().eq(0)).attr("alvoAtivo",0)),$(e).clone());$(n).addClass("cloneItens"),e.oldParent.find("."+i.SETTINGS.itemClass).remove(),e.oldParent.append(n),$(e).attr("alvoAtivo",1)}else{if(1==$(t).attr("alvoAtivo"))return!1;$(e).parent().removeAttr("a"+$(e).attr("indiceArraste")),$(e.oldParent).append(e),$(e.oldParent).find(".cloneItens").remove(),$(e).attr("alvoAtivo",0)}return i.action={status:"drop",response:{drag:e,drop:t}},i.SETTINGS.call(i),s(),!1}function s(){var a=0;$(i.$container).find(".alvo").each(function(e,t){a+=$(t).find(".arraste").length}),0<a?$(i.$container).find("."+i.SETTINGS.confirmarClass).removeClass("hide"):$(i.$container).find("."+i.SETTINGS.confirmarClass).addClass("hide")}$(i.$container).find("."+i.SETTINGS.itemClass).each(function(e,t){$(t).attr("arraste")&&(i.indiceArraste++,$(t).addClass("arraste"),$(t).addClass("arraste"+$(t).attr("arraste")),$(t).attr("indiceArraste",$(t).attr("arraste")),$(t)[0].parentInit=$(t).parent(),a?($(t).on("click",function(e){var t=this;i.$activeItem=t,$(i.$activeItem).attr("encap")||(i.$activeItemEncap=i.$activeItem),$("."+i.SETTINGS.featuredItemClass).removeClass(i.SETTINGS.featuredItemClass),$(i.$activeItem).addClass(i.SETTINGS.featuredItemClass)}),$(t).parent().on("click",function(e){n(this)})):(t.setAttribute("draggable","true"),$(t).on("dragstart",r),$(t).parent().on("dragover",l),$(t).parent().on("drop",o))),$(t).attr("alvo")&&(i.indiceAlvo++,t.old=t.innerHTML,$(t).addClass("alvo"),$(t).addClass("alvo"+i.indiceAlvo),$(t).attr("indiceAlvo",i.indiceAlvo),1<$(t).attr("alvo").split("|").length&&(i.individual=!1),a)&&$(t).on("click",function(e){n(this)}),a||($(t).on("dragover",l),$(t).on("drop",o))}),i.individual&&(i.SETTINGS.limiteAlvo=1),i.action={status:"init",response:!0},i.SETTINGS.call(i),$(i.$container).find("."+i.SETTINGS.confirmarClass).on("click",function(e){i.$activeItem=null,i.$alvoItem=null,i.$activeItemEncap=null,$("."+i.SETTINGS.featuredItemClass).removeClass(i.SETTINGS.featuredItemClass),$(i.$container).find(".alvo").each(function(e,t){$(t).find(".arraste").each(function(){var e=$(this).attr("arraste");$(t).attr("a"+e,1)})});var r,t,a,l=!0;"AND"==i.SETTINGS.model?$(i.$container).find(".alvo").each(function(e,t){if(0!=$(t).attr("alvo"))for(var a=$(t).attr("alvo").split("|"),n=0;n<a.length;n++)$(t).attr("a"+a[n])||(l=!1)}):(r=0,a=(t=$(i.$container).find(".alvo")).length,t.each(function(e,t){if(0!=$(t).attr("alvo"))for(var a=$(t).attr("alvo").split("|"),n=0;n<a.length;n++)$(t).attr("a"+a[n])&&(r+=1)}),l=a==r,console.log("alvosAll",a),console.log("alv",r)),i.action={status:"confirmar",response:l},i.SETTINGS.call(i)})};
//# sourceMappingURL=script-drag-drop-exerc.js.map
