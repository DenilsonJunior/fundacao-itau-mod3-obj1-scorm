events.on("ready",function(){function A(){var r,t,n,o,s,d,i,c,a;scorm.loadObject("dragdrop")&&(a=scorm.loadObject("dragdrop"),r=[],t=a.length,i=s=o=n=0,c=d=!1,$.each(a,function(t,a){var e={uidPAGE:a.uid,currentID:a.q,alternativas:a.a,status:a.r,tentativas:a.t};0==a.r&&(n+=1),1==a.r&&(o+=1),a.pq&&(s+=parseInt(a.pq),d=!0,e.pesoQuestao=a.pq),a.pa&&(i+=parseInt(a.pa),c=!0,e.pesoAlternativa=a.pa),r.push(e)}),a={dragdrop:r,total:t,erradas:n,corretas:o,porcentagem:parseInt(o/t*100),totalPesoQuestao:0,totalPesoAlternativas:0},d&&(a.totalPesoQuestao=s),c&&(a.totalPesoAlternativas=i),events.emit("dragdrop",a))}$(".exercise-drag-drop").each(function(t,a){var r=this,o=t,s=window.uid,d=0,i=0,c=0,t=$(r).attr("maxItensInAlvo")?$(r).attr("maxItensInAlvo"):1,e=$(r).attr("featuredClass")?$(r).attr("featuredClass"):"featured-item",n="relacionar"==$(r).attr("relacionar")||1==$(r).attr("relacionar"),l="random"==$(r).attr("random")||1==$(r).attr("random"),f=$(r).attr("standardBtn")?$(r).attr("standardBtn"):"confirmar",p=$(r).attr("repeatBtn")?$(r).attr("repeatBtn"):"refazer",u=$(r).attr("cacheBtn")?$(r).attr("cacheBtn"):"rever",v=$(r).attr("peso")?$(r).attr("peso"):-1,m=$(r).find(".item-select").length,h=(!$(r).attr("infoClass")||$(r).attr("infoClass"),$(r).attr("infoTxt")&&$(r).attr("infoTxt"),$(r).attr("model")?$(r).attr("model"):"OR"),g=null,b=$(r).hasClass("children-buzzfeed");$(r).find(".button-confirm").addClass("hide");function I(){$(r).find(".feedback").addClass("hide"),$(r).find(".button-confirm").html(f),$(r).find(".arraste").each(function(t,a){var e=$(a)[0].parentInit;$(e).find(".cloneItens").remove(),$(e).append(a),$(a).removeAttr("encap")}),$(r).find(".alvo").each(function(t,a){$(a).find(".arraste").remove(),$(r).find(".arraste").each(function(){var t=$(this).attr("arraste");$(a).removeAttr("a"+t)})})}function C(){$(r).find(".arraste").removeClass("featuredItens"),$(r).find(".arraste").css("pointer-events","none"),$(r).find(".alvo").css("pointer-events","none")}$(r).attr("repeat")&&(d=parseInt($(this).attr("repeat")),c=parseInt($(this).attr("repeat")),i=parseInt($(this).attr("repeat"))),I(),l&&$(r).find(".col-itens").html($(r).find(".col-itens .container-item").sort(function(){return Math.random()-.5})),$(r).find(".button-limpar").on("click",function(){I(),events.emit("dragdrop-reset")}),$(r).drag_drop_exerc({itemClass:"dragDrop_element",featuredItemClass:e,confirmarClass:"confirmar",limiteAlvo:parseInt(t),relacionar:n,model:h,call:function(t){var a;"init"==t.action.status&&$(r).attr("cache")&&scorm.loadObject("dragdrop")&&0<(a=scorm.loadObject("dragdrop")).length&&$.each(a,function(t,a){a.uid==s&&a.q==o&&($(r).find(".button-confirm").removeClass("hide"),$(r).find(".button-confirm").html(u),i=c=d=0,$(r).find(".alvo").each(function(t,r){t=a.a[t];0<t.length&&$.each(t,function(t,a){$(r).attr("a"+a,1),$(r).attr("alvoAtivo",1);var a=$(".arraste"+a),e=a.clone();a.addClass("cloneItens"),$(r).append(e)})}),C())}),"confirmar"==t.action.status&&(console.log(t.action.response),1==t.action.response?($(r).attr("res-feed",1),g="feedback-positive",d=0):($(r).attr("res-feed",0),g="feedback-negative",0<c&&c<=10&&(a=c-d+1,0<$(r).find(".feedback-negative"+a).length)&&(g="feedback-negative"+a)),b?($(r).find(".container-alternative").removeClass("actived"),$(r).trigger("buzzfeed",[$(r).attr("res-feed")]),$(r).find(".button-confirm").addClass("hide"),I()):(t=$(r).find("."+g),$("body").trigger("openModal",[t])))}}),$(r).find(".modal-close").on("click focusin",function(){$(r).find(".feedback").addClass("hide"),d<=0?($(this).attr("arrow_status_class")&&$("body").trigger("nextLiberate"),$(r).find(".container-alternative").addClass("respondido"),$(r).find(".button-confirm").html(u),C(),$(r).attr("cache")&&(e=[],n=[],scorm.loadObject("dragdrop")&&(e=scorm.loadObject("dragdrop")),$(r).find(".alvo").each(function(t,a){for(var e=[],r=1;r<=m;r++)$(this).attr("a"+r)&&e.push(r);n.push(e)}),$.each(e,function(t,a){try{a&&a.uid==s&&a.q==o&&e.splice(t,1)}catch(t){console.error("erro no array do dragdrop",t)}}),t={uid:s,q:o,a:n,r:parseInt($(r).attr("res-feed")),t:c-i},-1<v&&(t.pq=1==t.r?parseInt(v):0),e.push(t),scorm.saveObject("dragdrop",e),A())):(I(),$(r).find(".container-alternative").removeClass("respondido"),$(r).find(".button-confirm").html(p),$(r).find(".button-confirm").addClass("hide"),$(r).find(".container-alternative").removeClass("actived"),d--,i--);var e,n,t=$(r).find("."+g);$("body").trigger("closeModal",[t])})}),A()}),events.on("dragdrop",function(t){}),events.on("read-dragdrop",function(t){var a,r,e,n,o,s,d,i,c,l={};scorm.loadObject("dragdrop")&&(a=scorm.loadObject("dragdrop"),r=[],e=a.length,i=s=o=n=0,c=d=!1,$.each(a,function(t,a){var e={uidPAGE:a.uid,currentID:a.q,alternativas:a.a,status:a.r,tentativas:a.t};0==a.r&&(n+=1),1==a.r&&(o+=1),a.pq&&(s+=parseInt(a.pq),d=!0,e.pesoQuestao=a.pq),a.pa&&(i+=parseInt(a.pa),c=!0,e.pesoAlternativa=a.pa),r.push(e)}),l={dragdrop:r,total:e,erradas:n,corretas:o,porcentagem:parseInt(o/e*100),totalPesoQuestao:0,totalPesoAlternativas:0},d&&(l.totalPesoQuestao=s),c&&(l.totalPesoAlternativas=i),events.emit("dragdrop",l)),t.current=l}),events.on("dragdrop-reset",function(){console.log("dragdrop-reset"),scorm.removeObject("dragdrop")});
//# sourceMappingURL=exercise-drag-drop.js.map
